!function(e){var s={activeComponents:[],blogCard:async function(e,n,a){let t=document.createElement("div");t.classList=["blog-card"];let c=document.createElement("div");c.classList=["blog-cover"];let i=new Image;i.src=a,c.appendChild(i);let l=window.location.origin+"/blogs/"+e+"/can_edit_blog",r=await fetch(l,{method:"POST",headers:{"X-CSRFTOKEN":o("csrftoken")}});if(!0===(await r.json()).can_edit_blog){let e=document.createElement("div");e.classList=["options"];let s=document.createElement("div");s.classList+="option-btn edit",s.innerHTML='<i class="fas fa-edit    "></i>';let n=document.createElement("div");n.innerHTML='<i class="fas fa-trash    "></i>',n.classList="option-btn delete",e.appendChild(s),e.appendChild(n),c.appendChild(e)}let d=document.createElement("div");d.classList=["blog-footer"],d._id=e;let h=document.createElement("div");return h.classList=["title"],h.innerHTML="<p>"+n+"</p>",d.appendChild(h),t.appendChild(c),t.appendChild(d),d.addEventListener("click",s.eventHandlers.blogCard["blog-footer-click"]),t},eventHandlers:{blogCard:{"blog-footer-click":function(e){var s=e.currentTarget._id,n=window.location.origin+"/blogs/"+s;window.location.href=n}}}};let n=e(".notifications"),a=e(".nav-bar"),t=e(".notifys-container"),c=e(".search"),i=e(".search-container");function o(e){let s=document.cookie.split("; ").find(s=>s.startsWith(e));return s&&(s=s.split("=")[1]),s}function l(e,s){document.cookie=`${e}=${s};path=/`}document.location.origin;let r=document.location.pathname,d=document.getElementsByClassName("nav-link");for(let e of d){var h=e.pathname;console.log(h),h===r?e.classList+=" nav-active":"/accounts/login"!==h&&"/accounts/signup"!==h||(e.classList+=" nav-active")}let v={container:()=>e(".search-container"),setActiveType:(e,s)=>{v.container().find(".search-type .type-active").removeClass("type-active"),s.addClass("type-active"),v.activeType=e,l("active_srch_type",e)},searchTypes:["All","Blogs","Gamers","Videos","Games"],activeType:"All",children:{"min-search-options":e('<div class="min-search-options"></div>'),"min-search-option":e('<div class="min-search-option"></div>'),"sort-by":()=>{return e('<span class="sort-by"> Sort by <i class="fa fa-sort ml-1" aria-hidden="true"></i></span>')},"search-loading":e('<div class="search-loading"> <h1><i class="fa fa-search" aria-hidden="true"></i></h1></div>'),"search-type":e('<div class="search-type"></div>'),type:function(s,n){let a=e('<div class="type"></div>').text(s);return a.on("click",function(e){v.setActiveType(s,a)}),n&&a.addClass("type-active"),a},render:function(){let e=v.children["min-search-options"],s=v.children["min-search-option"];s.append(v.children["sort-by"]()),e.append(s);let n=v.children["search-type"],a=o("active_srch_type");for(let e of v.searchTypes){let s=!1;a||(a="All",l("active_srch_type","All")),s=e===a,console.log(s);let t=v.children.type(e,s);n.append(t)}e.append(n),v.container().find(".body").before(e)}},selectors:{searchBtn:()=>e(".search"),searchInput:()=>e(".search-container .search-input #search-text"),searchSubmit:()=>e(".search-container .search-input button"),searchBody:()=>e(".search-container .body")},is_loading:!1,search_text:"",request:async(e,s)=>{let n=new URL(window.location.origin+e),a={method:"POST",mode:"cors",cache:"no-cache",headers:{"Content-Type":"application/json","X-CSRFTOKEN":o("csrftoken")},body:JSON.stringify(s[0])};for(let e of s)console.log(e),n.searchParams.append(e.name,e.value);return await fetch(n,a)},search_functions:{videos:async e=>{},blogs:async e=>{let n=await v.request("/search/blogs/",[{name:"blog_query",value:e}]),a=await n.json();console.log("blog results = ",a);for await(let e of a.blogs){let n=window.location.origin+"/blogs/"+e._id+"/cover",a=await s.blogCard(e._id,e.title,n);v.selectors.searchBody().append(a)}},gamers:async e=>{let s=await v.request("/search/users/",[{name:"user_query",value:e}]),n=await s.json();console.log("users results = ",n)},games:async e=>{},all:async e=>{}},toggleLoading:e=>{var s=document.querySelector(".search-loading");s?s.remove():e.html(v.children["search-loading"])},render:function(){v.children.render(),v.selectors.searchInput().on("input",s=>{let n=e(s.currentTarget).val();""!==n&&(v.search_text=n)}),v.selectors.searchSubmit().on("click",async e=>{v.is_loading||(v.is_loading=!0,console.log("your search is ",v.search_text),v.toggleLoading(v.selectors.searchBody()),await v.search_functions[v.activeType.toLowerCase()](v.search_text),console.log("results is now available !"),v.toggleLoading(v.selectors.searchBody()),v.is_loading=!1)})}};n.on("click",function(){if(c.hasClass("nav-active"))c.removeClass("nav-active"),n.addClass("nav-active"),i.css({display:"none"}),t.css({display:"block"});else{let e="none",s="70px";"370px"===a.css("width")?s="70px":(s="370px",e="block"),a.animate({width:s},200,function(){t.css("display",e),n.hasClass("nav-active")?n.removeClass("nav-active"):n.addClass("nav-active")})}}),c.on("click",function(){e(".search-input input");if(n.hasClass("nav-active"))n.removeClass("nav-active"),c.addClass("nav-active"),t.css({display:"none"}),i.css({display:"block"});else{let e="none",s="70px";"370px"===a.css("width")?s="70px":(s="370px",e="block"),a.animate({width:s},200,function(){i.css("display",e),c.hasClass("nav-active")?c.removeClass("nav-active"):c.addClass("nav-active")})}}),document.models={success_msg:function(s){let n=e(`<div class="success-msg-container">\n                    <div class="success-msg">\n                        <div class="content">\n                        <h2><i class="fa fa-check-circle mr-3 color-success" aria-hidden="true"></i></h2>\n\n                            <h2>\n                                ${s}</h2>\n                        </div>\n                        <div class="btns-group">\n                            <div class="ok-btn">OK</div>\n                        </div>\n                    </div>\n                </div>`);return n.find(".btns-group .ok-btn").on("click",function(e){n.fadeToggle(300)}),n},append_success_msg:function(s){return e(".loading-bar").before(document.models.success_msg(s)),document.models.success_msg(s)},error_msg:function(s){let n=e(`<div class="success-msg-container">\n                    <div class="success-msg">\n                        <div class="content">\n                        <h2><i class="fa fa-check-circle mr-3" aria-hidden="true"></i></h2>\n\n                            <h2>\n                                ${s}</h2>\n                        </div>\n                        <div class="btns-group">\n                            <div class="ok-btn">OK</div>\n                        </div>\n                    </div>\n                </div>`);return n.find(".btns-group .ok-btn").on("click",function(e){n.fadeToggle(300)}),n},append_error_msg:function(s){return e(".loading-bar").before(document.models.success_msg(s)),document.models.success_msg(s)},components:s},v.render()}($);
